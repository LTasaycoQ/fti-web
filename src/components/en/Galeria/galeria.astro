---
interface Section {
    image: string;
    title: string;
    cat: string;
}

const roomsImport = import.meta.glob("../../../content/galeria.md", { eager: true });
const roomsData = Object.values(roomsImport) as any[];

const sections: Section[] = roomsData[0]?.frontmatter?.fotos ?? [];

---

<section class="w-full flex flex-col justify-center items-center mx-auto px-4 py-12">
    <div>
        <h1 class="title text-[50px]">Galeria</h1>
    </div>

    <div class="flex flex-wrap justify-center gap-4 mb-12">
        <button onclick="filtrar('todos')" class="btn-filtro active">Todos</button>
        <button onclick="filtrar('hoteles')" class="btn-filtro">Hoteles</button>
        <button onclick="filtrar('comida')" class="btn-filtro">Gastronomía</button>
        <button onclick="filtrar('masajes')" class="btn-filtro">Masajes</button>
    </div>

    <div id="galeria-fotos" class="pt-[30px] grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center w-full max-w-7xl">
        {
            sections.length > 0 ? (
                sections.map((foto) => (
                    <div class={`item-galeria ${foto.cat} group relative overflow-hidden rounded-2xl shadow-xl w-full max-w-[400px]`}>
                        <img 
                            src={foto.image} 
                            alt={foto.title} 
                            class="w-full h-80 object-cover transition-transform duration-500 group-hover:scale-110"
                            loading="lazy"
                        />
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-6">
                            <p class="text-white font-bold text-xl">{foto.title}</p>
                        </div>
                    </div>
                ))
            ) : (
                <p>No se encontraron imágenes en la galería.</p>
            )
        }
    </div>
</section>

<style>
    @reference "tailwindcss";

    .btn-filtro {
        @apply px-6 py-2 border-2 border-[#A71E1F] text-[#A71E1F] font-bold rounded-full transition-all duration-300 cursor-pointer;
    }

    .btn-filtro.active {
        @apply bg-[#A71E1F] text-white shadow-lg shadow-[#A71E1F]/50;
    }

    .item-galeria {
        display: block;
        animation: fadeIn 0.4s ease forwards;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: scale(0.95); }
        to { opacity: 1; transform: scale(1); }
    }
</style>

<script is:inline>
    function filtrar(categoria) {
        const items = document.querySelectorAll('.item-galeria');
        const botones = document.querySelectorAll('.btn-filtro');

        botones.forEach(btn => {
            btn.classList.remove('active');
            if(btn.innerText.toLowerCase().includes(categoria.toLowerCase()) || 
               (categoria === 'todos' && btn.innerText.toLowerCase() === 'todos')) {
                btn.classList.add('active');
            }
        });

        items.forEach(item => {
            if (categoria === 'todos' || item.classList.contains(categoria)) {
                item.style.display = 'block';
            } else {
                item.style.display = 'none';
            }
        });
    }
</script>